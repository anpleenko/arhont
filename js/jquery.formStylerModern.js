(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(e){"use strict";var t="styler",i="-"+t,s="jq-",l={wrapper:"form",filePlaceholder:"Файл не выбран",fileBrowse:"Обзор...",fileNumber:"Выбрано файлов: %s",selectPlaceholder:"Выберите...",selectSearch:false,selectSearchLimit:10,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Поиск...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:true,checkboxIndeterminate:false,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};function o(t,i){this.element=t;this.options=e.extend({},l,i);this.init()}o.prototype={init:function(){var l=e(this.element),o=this.options;var n=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?true:false,d=navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?true:false;function r(){var e="",s="",o="",a="";if(l.attr("id")!==undefined&&l.attr("id")!==""){e=' id="'+l.attr("id")+i+'"'}if(l.attr("title")!==undefined&&l.attr("title")!==""){s=' title="'+l.attr("title")+'"'}if(l.attr("class")!==undefined&&l.attr("class")!==""){o=" "+l.attr("class")}var n=l.data();for(var d in n){if(n[d]!==""&&d!=="_"+t){a+=" data-"+d+'="'+n[d]+'"'}}e+=a;this.id=e;this.title=s;this.classes=o}if(l.is(":checkbox")){var c=function(){var i=new r,a=e("<div"+i.id+' class="'+s+"checkbox"+i.classes+'"'+i.title+'><div class="'+s+'checkbox__div"></div></div>');l.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(a).prependTo(a);a.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"});if(l.is(":disabled")){a.addClass("disabled")}a.click(function(e){e.preventDefault();if(!a.is(".disabled")){if(l.is(":checked")||l.is(":indeterminate")){l.prop("checked",o.checkboxIndeterminate===true&&l.is(":indeterminate"));l.prop("indeterminate",false)}else{if(o.checkboxIndeterminate===true){l.prop("checked",false);l.prop("indeterminate",true)}else{l.prop("checked",true);l.prop("indeterminate",false)}}l.focus().change()}});l.closest("label").add('label[for="'+l.attr("id")+'"]').on("click."+t,function(t){if(!e(t.target).is("a")&&!e(t.target).closest(a).length){a.triggerHandler("click");t.preventDefault()}});l.on("change."+t,function(){if(l.is(":checked")||l.is(":indeterminate")){if(l.is(":indeterminate")){a.removeClass("checked");a.addClass("indeterminate")}else{a.removeClass("indeterminate");a.addClass("checked")}}else{a.removeClass("indeterminate");a.removeClass("checked")}}).on("keydown."+t,function(e){if(e.which===32){e.preventDefault();a.click()}}).on("focus."+t,function(){if(!a.is(".disabled")){a.addClass("focused")}}).on("blur."+t,function(){a.removeClass("focused")});l.change()};c();l.on("refresh",function(){l.closest("label").add('label[for="'+l.attr("id")+'"]').off("."+t);l.off("."+t).parent().before(l).remove();c()})}else if(l.is(":radio")){var f=function(){var i=new r,a=e("<div"+i.id+' class="'+s+"radio"+i.classes+'"'+i.title+'><div class="'+s+'radio__div"></div></div>');l.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(a).prependTo(a);a.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"});if(l.is(":disabled")){a.addClass("disabled")}a.click(function(t){t.preventDefault();if(!a.is(".disabled")){var i=a.closest(o.wrapper).find('input[name="'+l.attr("name")+'"]:radio');if(i.length<=0){i=a.closest("#"+l.attr("name")).find('input[name="'+l.attr("name")+'"]:radio')}if(i.length<=0){i=e("body").find('input[name="'+l.attr("name")+'"]:radio')}i.prop("checked",false).parent().removeClass("checked");l.prop("checked",true).focus().change()}});l.on("change."+t,function(t){if(!l.is(":disabled")){if(e(this).is(":checked")){l.parent().addClass("checked")}else{l.parent().removeClass("checked")}}}).on("focus."+t,function(){if(!a.is(".disabled")){a.addClass("focused")}}).on("blur."+t,function(){a.removeClass("focused")});l.closest("label").add('label[for="'+l.attr("id")+'"]').on("click."+t,function(t){if(!e(t.target).is("a")&&!e(t.target).closest(a).length){a.triggerHandler("click");t.preventDefault()}});l.change()};f();l.on("refresh",function(){l.closest("label").add('label[for="'+l.attr("id")+'"]').off("."+t);l.off("."+t).parent().before(l).remove();f()})}else if(l.is(":file")){l.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0});var u=function(){var i=new r,a=l.data("placeholder"),n=l.data("browse");if(a===undefined){a=o.filePlaceholder}if(n===undefined||n===""){n=o.fileBrowse}var d=e("<div"+i.id+' class="'+s+"file"+i.classes+'"'+i.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),c=e('<div class="'+s+'file__name">'+a+"</div>").appendTo(d);e('<div class="'+s+'file__browse">'+n+"</div>").appendTo(d);l.after(d).appendTo(d);if(l.is(":disabled")){d.addClass("disabled")}l.on("change."+t,function(){var e=l.val();if(l.is("[multiple]")){var t=l[0].files.length;e="";if(t>0){var i=l.data("number");if(i===undefined){i=o.fileNumber}i=i.replace("%s",t);e=i}}c.text(e.replace(/.+[\\\/]/,""));if(e===""){c.text(a);d.removeClass("changed")}else{d.addClass("changed")}}).on("focus."+t,function(){d.addClass("focused")}).on("blur."+t,function(){d.removeClass("focused")}).on("click."+t,function(){d.removeClass("focused")});l.change()};u();l.on("refresh",function(){l.off("."+t).parent().before(l).remove();u()})}else if(l.is('input[type="number"]')){var h=function(){var i=e('<div class="'+s+'number"><div class="'+s+'number__spin minus"></div><div class="'+s+'number__spin plus"></div></div>'),o,a,n,d=null,r=null;l.after(i).prependTo(i).wrap('<div class="'+s+'number__field"></div>');if(l.is(":disabled")){i.addClass("disabled")}if(l.attr("min")!==undefined){o=l.attr("min")}if(l.attr("max")!==undefined){a=l.attr("max")}if(l.attr("step")!==undefined&&e.isNumeric(l.attr("step"))){n=Number(l.attr("step"))}else{n=Number(1)}var c=function(t){var i=l.val(),s;if(!e.isNumeric(i)){i=0;l.val("0").change()}if(t.is(".minus")){s=parseInt(i,10)-n;if(n>0){s=Math.ceil(s/n)*n}}else if(t.is(".plus")){s=parseInt(i,10)+n;if(n>0){s=Math.floor(s/n)*n}}if(e.isNumeric(o)&&e.isNumeric(a)){if(s>=o&&s<=a){l.val(s).change()}}else if(e.isNumeric(o)&&!e.isNumeric(a)){if(s>=o){l.val(s).change()}}else if(!e.isNumeric(o)&&e.isNumeric(a)){if(s<=a){l.val(s).change()}}else{l.val(s).change()}};if(!i.is(".disabled")){i.on("mousedown","div."+s+"number__spin",function(){var t=e(this);c(t);d=setTimeout(function(){r=setInterval(function(){c(t)},40)},350)}).on("mouseup mouseout","div."+s+"number__spin",function(){clearTimeout(d);clearInterval(r)});l.on("focus."+t,function(){i.addClass("focused")}).on("blur."+t,function(){i.removeClass("focused")})}l.change()};h();l.on("refresh",function(){l.off("."+t).closest("."+s+"number").before(l).remove();h()})}else if(l.is("select")){var p=function(){function c(t){t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(t){var i=null;if(t.type==="mousewheel"){i=t.originalEvent.wheelDelta*-1}else if(t.type==="DOMMouseScroll"){i=40*t.originalEvent.detail}if(i){t.stopPropagation();t.preventDefault();e(this).scrollTop(i+e(this).scrollTop())}})}var f=e("option",l),u="";function h(){for(var e=0;e<f.length;e++){var t=f.eq(e),s="",l="",o="",a="",n="",d="",r="",c="",h="",p="disabled",v="selected sel disabled";if(t.prop("selected")){l="selected sel"}if(t.is(":disabled")){l=p}if(t.is(":selected:disabled")){l=v}if(t.attr("id")!==undefined&&t.attr("id")!==""){a=' id="'+t.attr("id")+i+'"'}if(t.attr("title")!==undefined&&f.attr("title")!==""){n=' title="'+t.attr("title")+'"'}if(t.attr("class")!==undefined){r=" "+t.attr("class");h=' data-jqfs-class="'+t.attr("class")+'"'}var m=t.data();for(var g in m){if(m[g]!==""){d+=" data-"+g+'="'+m[g]+'"'}}if(l+r!==""){o=' class="'+l+r+'"'}s="<li"+h+d+o+n+a+">"+t.html()+"</li>";if(t.parent().is("optgroup")){if(t.parent().attr("class")!==undefined){c=" "+t.parent().attr("class")}s="<li"+h+d+' class="'+l+r+" option"+c+'"'+n+a+">"+t.html()+"</li>";if(t.is(":first-child")){s='<li class="optgroup'+c+'">'+t.parent().attr("label")+"</li>"+s}}u+=s}}function p(){var i=new r,p="",v=l.data("placeholder"),m=l.data("search"),g=l.data("search-limit"),b=l.data("search-not-found"),C=l.data("search-placeholder"),w=l.data("z-index"),x=l.data("smart-positioning");if(v===undefined){v=o.selectPlaceholder}if(m===undefined||m===""){m=o.selectSearch}if(g===undefined||g===""){g=o.selectSearchLimit}if(b===undefined||b===""){b=o.selectSearchNotFound}if(C===undefined){C=o.selectSearchPlaceholder}if(w===undefined||w===""){w=o.singleSelectzIndex}if(x===undefined||x===""){x=o.selectSmartPositioning}var y=e("<div"+i.id+' class="'+s+"selectbox jqselect"+i.classes+'" style="display: inline-block; position: relative; z-index:'+w+'">'+'<div class="'+s+'selectbox__select"'+i.title+' style="position: relative">'+'<div class="'+s+'selectbox__select-text"></div>'+'<div class="'+s+'selectbox__trigger"><div class="'+s+'selectbox__trigger-arrow"></div></div>'+"</div>"+"</div>");l.css({margin:0,padding:0}).after(y).prependTo(y);var _=e("div."+s+"selectbox__select",y),k=e("div."+s+"selectbox__select-text",y),T=f.filter(":selected");h();if(m){p='<div class="'+s+'selectbox__search"><input type="search" autocomplete="off" placeholder="'+C+'"></div>'+'<div class="'+s+'selectbox__not-found">'+b+"</div>"}var S=e('<div class="'+s+'selectbox__dropdown" style="position: absolute">'+p+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+u+"</ul>"+"</div>");y.append(S);var q=e("ul",S),j=e("li",S),I=e("input",S),N=e("div."+s+"selectbox__not-found",S).hide();if(j.length<g){I.parent().hide()}if(T.text()===""){k.text(v).addClass("placeholder")}else{k.text(T.text())}var A=0,P=0;j.css({display:"inline-block"});j.each(function(){var t=e(this);if(t.innerWidth()>A){A=t.innerWidth();P=t.width()}});j.css({display:""});if(k.is(".placeholder")&&k.width()>A){k.width(k.width())}else{var D=y.clone().appendTo("body").width("auto");var H=D.outerWidth();D.remove();if(H===y.outerWidth()){k.width(P)}}if(A>y.width()){S.width(A)}if(f.first().text()===""&&l.data("placeholder")!==""){j.first().hide()}l.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var z=y.outerHeight(true),M=I.parent().outerHeight(true),K=q.css("max-height"),O=j.filter(".selected"),W=S.css("top");if(O.length<1){j.first().addClass("selected sel")}if(j.data("li-height")===undefined){j.data("li-height",j.outerHeight())}if(S.css("left")==="auto"){S.css({left:0})}if(S.css("top")==="auto"){S.css({top:z})}S.hide();if(O.length){if(f.first().text()!==T.text()){y.addClass("changed")}y.data("jqfs-class",O.data("jqfs-class"));y.addClass(O.data("jqfs-class"))}if(l.is(":disabled")){y.addClass("disabled");return false}_.click(function(){if(e("div."+s+"selectbox").filter(".opened").length){o.onSelectClosed.call(e("div."+s+"selectbox").filter(".opened"))}l.focus();if(d||n){return}var t=e(window),i=j.data("li-height"),a=y.offset().top,r=t.height()-z-(a-t.scrollTop()),u=l.data("visible-options"),h=i*5,p=i*u;if(u===undefined||u===""){u=o.selectVisibleOptions}if(u>0&&u<6){h=p}if(u===0){p="auto"}var v=function(){var e=function(){q.css("max-height",Math.floor((r-20-M)/i)*i)};S.height("auto").css({bottom:"auto",top:W});e();q.css("max-height",p);if(K!=="none"){q.css("max-height",K)}if(r<S.outerHeight()+20){e()}};var m=function(){var e=function(){q.css("max-height",Math.floor((a-t.scrollTop()-20-M)/i)*i)};S.height("auto").css({top:"auto",bottom:W});e();q.css("max-height",p);if(K!=="none"){q.css("max-height",K)}if(a-t.scrollTop()-20<S.outerHeight()+20){e()}};if(x===true||x===1){if(r>h+M+20){v();y.removeClass("dropup").addClass("dropdown")}else{m();y.removeClass("dropdown").addClass("dropup")}}else if(x===false||x===0){if(r>h+M+20){v();y.removeClass("dropup").addClass("dropdown")}}if(y.offset().left+S.outerWidth()>t.width()){S.css({left:"auto",right:0})}e("div.jqselect").css({zIndex:w-1}).removeClass("opened");y.css({zIndex:w});if(S.is(":hidden")){e("div."+s+"selectbox__dropdown:visible").hide();S.show();y.addClass("opened focused");o.onSelectOpened.call(y)}else{S.hide();y.removeClass("opened dropup dropdown");if(e("div."+s+"selectbox").filter(".opened").length){o.onSelectClosed.call(y)}}if(I.length){I.val("").keyup();N.hide();I.keyup(function(){var t=e(this).val();j.each(function(){if(!e(this).html().match(new RegExp(".*?"+t+".*?","i"))){e(this).hide()}else{e(this).show()}});if(f.first().text()===""&&l.data("placeholder")!==""){j.first().hide()}if(j.filter(":visible").length<1){N.show()}else{N.hide()}})}if(j.filter(".selected").length){if(l.val()===""){q.scrollTop(0)}else{if(q.innerHeight()/i%2!==0){i=i/2}q.scrollTop(q.scrollTop()+j.filter(".selected").position().top-q.innerHeight()/2+i)}}c(q)});j.hover(function(){e(this).siblings().removeClass("selected")});var F=j.filter(".selected").text();j.filter(":not(.disabled):not(.optgroup)").click(function(){var t=e(this),i=t.text();l.focus();if(!t.is(".selected")){var s=t.index();s-=t.prevAll(".optgroup").length;t.addClass("selected sel").siblings().removeClass("selected sel");f.prop("selected",false).eq(s).prop("selected",true);F=i;k.text(i);if(y.data("jqfs-class")){y.removeClass(y.data("jqfs-class"))}y.data("jqfs-class",t.data("jqfs-class"));y.addClass(t.data("jqfs-class"));l.change()}S.hide();y.removeClass("opened dropup dropdown");o.onSelectClosed.call(y)});S.mouseout(function(){e("li.sel",S).addClass("selected")});l.on("change."+t,function(){k.text(f.filter(":selected").text()).removeClass("placeholder");j.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel");if(f.first().text()!==j.filter(".selected").text()){y.addClass("changed")}else{y.removeClass("changed")}}).on("focus."+t,function(){y.addClass("focused");e("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div."+s+"selectbox__dropdown").hide()}).on("blur."+t,function(){y.removeClass("focused")}).on("keydown."+t+" keyup."+t,function(e){var t=j.data("li-height");if(l.val()===""){k.text(v).addClass("placeholder")}else{k.text(f.filter(":selected").text())}j.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel");if(e.which===38||e.which===37||e.which===33||e.which===36){if(l.val()===""){q.scrollTop(0)}else{q.scrollTop(q.scrollTop()+j.filter(".selected").position().top)}}if(e.which===40||e.which===39||e.which===34||e.which===35){q.scrollTop(q.scrollTop()+j.filter(".selected").position().top-q.innerHeight()+t)}if(e.which===13){e.preventDefault();S.hide();y.removeClass("opened dropup dropdown");o.onSelectClosed.call(y)}}).on("keydown."+t,function(e){if(e.which===32){e.preventDefault();_.click()}});if(!a.registered){e(document).on("click",a);a.registered=true}}function v(){var i=new r,o=e("<div"+i.id+' class="'+s+"select-multiple jqselect"+i.classes+'"'+i.title+' style="display: inline-block; position: relative"></div>');l.css({margin:0,padding:0}).after(o);h();o.append("<ul>"+u+"</ul>");var a=e("ul",o).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),n=e("li",o).attr("unselectable","on"),d=l.attr("size"),p=a.outerHeight(),v=n.outerHeight();if(d!==undefined&&d>0){a.css({height:v*d})}else{a.css({height:v*4})}if(p>o.height()){a.css("overflowY","scroll");c(a);if(n.filter(".selected").length){a.scrollTop(a.scrollTop()+n.filter(".selected").position().top)}}l.prependTo(o).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});if(l.is(":disabled")){o.addClass("disabled");f.each(function(){if(e(this).is(":selected")){n.eq(e(this).index()).addClass("selected")}})}else{n.filter(":not(.disabled):not(.optgroup)").click(function(t){l.focus();var i=e(this);if(!t.ctrlKey&&!t.metaKey){i.addClass("selected")}if(!t.shiftKey){i.addClass("first")}if(!t.ctrlKey&&!t.metaKey&&!t.shiftKey){i.siblings().removeClass("selected first")}if(t.ctrlKey||t.metaKey){if(i.is(".selected")){i.removeClass("selected first")}else{i.addClass("selected first")}i.siblings().removeClass("first")}if(t.shiftKey){var s=false,o=false;i.siblings().removeClass("selected").siblings(".first").addClass("selected");i.prevAll().each(function(){if(e(this).is(".first")){s=true}});i.nextAll().each(function(){if(e(this).is(".first")){o=true}});if(s){i.prevAll().each(function(){if(e(this).is(".selected")){return false}else{e(this).not(".disabled, .optgroup").addClass("selected")}})}if(o){i.nextAll().each(function(){if(e(this).is(".selected")){return false}else{e(this).not(".disabled, .optgroup").addClass("selected")}})}if(n.filter(".selected").length===1){i.addClass("first")}}f.prop("selected",false);n.filter(".selected").each(function(){var t=e(this),i=t.index();if(t.is(".option")){i-=t.prevAll(".optgroup").length}f.eq(i).prop("selected",true)});l.change()});f.each(function(t){e(this).data("optionIndex",t)});l.on("change."+t,function(){n.removeClass("selected");var t=[];f.filter(":selected").each(function(){t.push(e(this).data("optionIndex"))});n.not(".optgroup").filter(function(i){return e.inArray(i,t)>-1}).addClass("selected")}).on("focus."+t,function(){o.addClass("focused")}).on("blur."+t,function(){o.removeClass("focused")});if(p>o.height()){l.on("keydown."+t,function(e){if(e.which===38||e.which===37||e.which===33){a.scrollTop(a.scrollTop()+n.filter(".selected").position().top-v)}if(e.which===40||e.which===39||e.which===34){a.scrollTop(a.scrollTop()+n.filter(".selected:last").position().top-a.innerHeight()+v*2)}})}}}if(l.is("[multiple]")){if(d||n){return}v()}else{p()}};p();l.on("refresh",function(){l.off("."+t).parent().before(l).remove();p()})}else if(l.is('input[type="hidden"]')){return false}else if(l.is("input")){l.addClass(t)}else if(l.is(":reset")){l.on("click",function(){setTimeout(function(){l.closest(o.wrapper).find("input, select").trigger("refresh")},1)})}},destroy:function(i){var l=e(this.element);if(!i){l.removeData("_"+t)}if(l.is(":checkbox")||l.is(":radio")){l.off("."+t+" refresh").removeAttr("style").parent().before(l).remove();l.closest("label").add('label[for="'+l.attr("id")+'"]').off("."+t)}else if(l.is('input[type="number"]')){l.off("."+t+" refresh").closest("."+s+"number").before(l).remove()}else if(l.is(":file")||l.is("select")){l.off("."+t+" refresh").removeAttr("style").parent().before(l).remove()}},reinitialize:function(t){this.destroy(true);this.options=e.extend({},l,t);this.init()}};e.fn[t]=function(i){var s=arguments;if(i===undefined||typeof i==="object"){this.each(function(){if(!e.data(this,"_"+t)){e.data(this,"_"+t,new o(this,i))}}).promise().done(function(){var i=e(this[0]).data("_"+t);if(i){i.options.onFormStyled.call()}});return this}else if(typeof i==="string"&&i[0]!=="_"&&i!=="init"){var l;this.each(function(){var a=e.data(this,"_"+t);if(a instanceof o&&typeof a[i]==="function"){l=a[i].apply(a,Array.prototype.slice.call(s,1))}});return l!==undefined?l:this}};function a(i){if(!e(i.target).parents().hasClass(""+s+"selectbox")&&i.target.nodeName!=="OPTION"){if(e("div."+s+"selectbox.opened").length){var l=e("div."+s+"selectbox.opened"),o=e("div."+s+"selectbox__search input",l),a=e("div."+s+"selectbox__dropdown",l),n=l.find("select").data("_"+t).options;n.onSelectClosed.call(l);if(o.length){o.val("").keyup()}a.hide().find("li.sel").addClass("selected");l.removeClass("focused opened dropup dropdown")}}}a.registered=false});
